<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DANÇA é isso aqui, ó</title>

<style>
html,body{
margin:0;
padding:0;
overflow:hidden;
background:#000;
font-family:Arial, sans-serif;
color:white;
}

#bgCanvas{
position:fixed;
inset:0;
z-index:0;
}

#mainLayer{
position:relative;
z-index:1;
display:flex;
flex-direction:column;
height:100vh;
}

header{
display:flex;
justify-content:center;
padding:2vh 0;
}

#headerLogo{
width:clamp(150px,30vw,300px);
}

#gameContainer{
flex:1;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:4vh;
}

#contentDisplay{
visibility:hidden;
font-size:clamp(2rem,5vw,4rem);
}

#revealBtn{
width:clamp(40px,7vw,75px);
cursor:pointer;
}
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<div id="mainLayer">
<header>
<img id="headerLogo"
src="https://redesencontros.github.io/dancaeissoaquio/assets/header.png">
</header>

<div id="gameContainer">
<div id="contentDisplay"></div>
<img id="revealBtn"
src="https://redesencontros.github.io/dancaeissoaquio/assets/button.png">
</div>
</div>

<script>

/* ================= BUTTON ================= */

const btn = document.getElementById("revealBtn");
const content = document.getElementById("contentDisplay");

btn.addEventListener("click", () => {
  content.style.visibility = "visible";
  content.textContent = "DANÇA é isso aqui, ó";
});


/* ================= IMPROVED MURMURATION ================= */

const canvas = document.getElementById("bgCanvas");
const ctx = canvas.getContext("2d", { alpha: false });

let width, height;

function resize() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

const BOID_COUNT = 2500;
const boids = [];

const perception = 35;
const perceptionSq = perception * perception;

class Boid {
  constructor() {
    this.x = Math.random() * width;
    this.y = Math.random() * height;
    this.vx = (Math.random() - 0.5) * 2;
    this.vy = (Math.random() - 0.5) * 2;
  }

  update() {
    let alignX = 0, alignY = 0;
    let cohesionX = 0, cohesionY = 0;
    let separationX = 0, separationY = 0;
    let count = 0;

    for (let other of boids) {
      if (other === this) continue;

      const dx = other.x - this.x;
      const dy = other.y - this.y;
      const distSq = dx * dx + dy * dy;

      if (distSq < perceptionSq) {
        alignX += other.vx;
        alignY += other.vy;
        cohesionX += other.x;
        cohesionY += other.y;

        if (distSq < 100) {
          separationX -= dx;
          separationY -= dy;
        }

        count++;
      }
    }

    if (count > 0) {
      alignX /= count;
      alignY /= count;
      cohesionX /= count;
      cohesionY /= count;

      this.vx += (alignX - this.vx) * 0.05;
      this.vy += (alignY - this.vy) * 0.05;
      this.vx += (cohesionX - this.x) * 0.0008;
      this.vy += (cohesionY - this.y) * 0.0008;
      this.vx += separationX * 0.01;
      this.vy += separationY * 0.01;
    }

    const speed = Math.sqrt(this.vx*this.vx + this.vy*this.vy);
    const max = 2;

    if (speed > max) {
      this.vx = (this.vx / speed) * max;
      this.vy = (this.vy / speed) * max;
    }

    this.x += this.vx;
    this.y += this.vy;

    // wrap screen
    if (this.x < 0) this.x = width;
    if (this.x > width) this.x = 0;
    if (this.y < 0) this.y = height;
    if (this.y > height) this.y = 0;
  }
}

for (let i = 0; i < BOID_COUNT; i++) {
  boids.push(new Boid());
}

function animate() {
  ctx.fillStyle = "black";
  ctx.fillRect(0, 0, width, height);

  ctx.fillStyle = "white";

  for (let b of boids) {
    b.update();
    ctx.fillRect(b.x, b.y, 1.5, 1.5);
  }

  requestAnimationFrame(animate);
}

animate();

</script>

</body>
</html>

